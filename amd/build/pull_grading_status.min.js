define("qtype_moopt/pull_grading_status",["core/ajax","core/modal_factory","core/modal_events","core/str"],(function(ajax,ModalFactory,ModalEvents,Strings){var timer,qubaid,isCurrentlyShowingModal=!1;function checkGradingFinished(){ajax.call([{methodname:"qtype_moopt_service_retrieve_grading_results",args:{qubaid:qubaid},done:function(result){result.estimatedSecondsRemainingForEachQuestion.forEach((function(estimatedSecondsRemainingForOneQuestion){document.getElementsByClassName("estimatedSecondsRemaining_"+estimatedSecondsRemainingForOneQuestion.questionId).forEach((function(div){"none"===div.style.display&&(div.style.display="block")})),document.getElementsByClassName("estimatedSecondsRemainingValue_"+estimatedSecondsRemainingForOneQuestion.questionId).forEach((function(elem){elem.innerHTML=estimatedSecondsRemainingForOneQuestion.estimatedSecondsRemaining}))})),result.finished&&function(){if(isCurrentlyShowingModal)return;isCurrentlyShowingModal=!0;var strings=[{key:"reloadpage",component:"qtype_moopt"},{key:"gradeprocessfinished",component:"qtype_moopt"},{key:"reload",component:"qtype_moopt"}];Strings.get_strings(strings).then((function(values){ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:values[0],body:values[1]}).done((function(modal){modal.setSaveButtonText(values[2]),modal.getRoot().on(ModalEvents.save,(function(){location.reload(!0),isCurrentlyShowingModal=!1})),modal.getRoot().on(ModalEvents.hidden,(function(){isCurrentlyShowingModal=!1})),modal.show()}))}))}()},fail:function(errorObject){console.log(errorObject)}}])}return{init:function(qubaid_param,slot,polling_interval){document.querySelectorAll("input[name='redoslot"+slot+"'").forEach((function(elem){elem.remove()})),qubaid=qubaid_param,void 0===timer&&(timer=setInterval(checkGradingFinished,polling_interval))}}}));

//# sourceMappingURL=pull_grading_status.min.js.map