define ("qtype_moopt/creation_via_drag_and_drop",["core/ajax","qtype_moopt/edit_editor_content"],function(a,b){return{init:function init(a){var b=this;document.querySelector("#loadproformataskfilebutton").addEventListener("click",function(){b.extractInformation(a)})},extractInformation:function extractInformation(c){var d=document.querySelector("#id_proformataskfileupload").parentNode,e=null;d.childNodes.forEach(function(a){if("proformataskfileupload"==a.name&&null===e){e=a.value}});a.call([{methodname:"qtype_moopt_extract_task_infos_from_draft_file",args:{itemid:e},done:function done(a){if("undefined"!=typeof a.error){document.querySelector("#id_error_ajaxerrorlabel").parentNode.children.item(0).innerHTML="<div>"+a.error+"</div>";document.querySelector("#id_error_ajaxwarnlabel").parentNode.children.item(0).innerHTML="";return}document.querySelector("#id_error_ajaxerrorlabel").parentNode.children.item(0).innerHTML="";document.querySelector("#id_name").value=a.title;b.setContents("id_questiontext",a.description);b.setContents("id_internaldescription",a.internaldescription);b.setContentsOfText("id_taskuuid",a.taskuuid);b.setContentsOfText("id_defaultmark",a.maxscoregradinghints);b.setContents("id_generalfeedback",a.filesdisplayedingeneralfeedback);if(0<c.length){for(var d=c[0],f=document.querySelector("#id_graderselect"),e=f.options[f.selectedIndex].value,g=0,h;g<c.length;g++){h=c[g].html_representation;if(h===e){d=c[g];break}}var u=[];c.forEach(function(b){if("proglangs"in b){for(var c=0;c<b.proglangs.length;c++){if(b.proglangs[c].toLowerCase()===a.proglang.toLowerCase()){u.push(b);break}}}});if(0<u.length){var j=[],l=u[0].name;u.forEach(function(a){if(a.name===l){j.push(a)}});if(0<j.length){d=j[0];for(var v=1;v<j.length;v++){for(var m=j[v].version.split("."),n=d.version.split("."),o=0;2>o;o++){if(parseInt(m[o])>parseInt(n[o])){d=j[v];break}else if(parseInt(m[o])<parseInt(n[o])){break}}}}}var p=d.html_representation,q="#id_graderselect option[value='"+p+"']";document.querySelector(q).selected=!0;if("result_spec"in d){if("format"in d.result_spec){p=d.result_spec.format;q="#id_resultspecformat option[value='"+p+"']";document.querySelector(q).selected=!0}if("structure"in d.result_spec){p=d.result_spec.structure;q="#id_resultspecstructure option[value='"+p+"']";document.querySelector(q).selected=!0}if("teacher_feedback_level"in d.result_spec){p=d.result_spec.teacher_feedback_level;q="#id_teacherfeedbacklevel option[value='"+p+"']";document.querySelector(q).selected=!0}if("student_feedback_level"in d.result_spec){p=d.result_spec.student_feedback_level;q="#id_studentfeedbacklevel option[value='"+p+"']";document.querySelector(q).selected=!0}}}var r=document.querySelector("#id_enablefilesubmissions");r.checked=!a.enablefileinput;r.click();var s=a.freetextfilesettings.length;r=document.querySelector("#id_enablefreetextsubmissions");r.checked=!(0<s);r.click();if(0<s){r=document.querySelector("#id_ftsnuminitialfields");r.value=s;r.click();r=document.querySelector("#id_ftsmaxnumfields");r.value=s;r.click();r.dispatchEvent(new Event("change"));r=document.querySelector("#id_enablecustomsettingsforfreetextinputfields");r.checked=!1;r.click();for(var k=0;k<a.freetextfilesettings.length;k++){r=document.querySelector("#id_enablecustomsettingsforfreetextinputfield"+k);r.checked=!a.freetextfilesettings[k].enablecustomsettings;r.click();if(!0==a.freetextfilesettings[k].usefixedfilename){r=document.querySelector("#id_namesettingsforfreetextinput"+k+"_0");r.checked=!1;r.click()}else{r=document.querySelector("#id_namesettingsforfreetextinput"+k+"_1");r.checked=!1;r.click()}document.querySelector("#id_freetextinputfieldname"+k).value=a.freetextfilesettings[k].defaultfilename;document.querySelector("#id_freetextinputfieldtemplate"+k).value=a.freetextfilesettings[k].filecontent;document.querySelector("#id_ftsoverwrittenlang"+k).value=a.freetextfilesettings[k].proglang;document.querySelector("#id_ftsinitialdisplayrows"+k).value=a.freetextfilesettings[k].initialdisplayrows}}var t="";if("undefined"!=typeof a.moodleValidationProformaNamespace){t+="<p>Detected ProFormA-version "+a.moodleValidationProformaNamespace+"</p>"}if("undefined"!=typeof a.moodleValidationWarningInvalidNamespace){t+="<p>"+a.moodleValidationWarningInvalidNamespace+"</p>"}if("undefined"!=typeof a.moodleValidationWarnings){t+="<p>Found the following problems during validation but still continued:</p><ul>";a.moodleValidationWarnings.forEach(function(a){t+="<li>"+a.msg+"</li>"});t+="</ul>"}document.querySelector("#id_error_ajaxwarninglabel").parentNode.children.item(0).innerHTML=t;document.querySelector("#loadproformataskfilebutton").focus()},fail:function fail(a){console.log(a);document.querySelector("#id_error_ajaxerrorlabel").parentNode.children.item(0).innerHTML="<div>"+a.debuginfo+"</div><div> For more information see browser console.</div>";document.querySelector("#id_error_ajaxwarninglabel").parentNode.children.item(0).innerHTML=""}}])}}});
//# sourceMappingURL=creation_via_drag_and_drop.min.js.map
